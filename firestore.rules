rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /patients/{patientId} {
      allow read: if request.auth != null;
      allow create, update: if request.auth != null
        && request.resource.data.keys().hasOnly([
          'name',
          'age',
          'condition',
          'lastSession',
          'therapistNotes',
          'totalHours',
          'avgGripStrength',
          'goalsCompleted',
          'targetStrength',
          'avatarUrl',
          'avatarHint',
          'gripStrengthHistory',
          'therapyHoursHistory'
        ])
        && request.resource.data.name is string
        && request.resource.data.condition is string
        && request.resource.data.avatarUrl is string
        && request.resource.data.avatarHint is string
        && request.resource.data.lastSession is string
        && request.resource.data.age is number
        && request.resource.data.totalHours is number
        && request.resource.data.avgGripStrength is number
        && request.resource.data.goalsCompleted is number
        && request.resource.data.targetStrength is number
        && request.resource.data.gripStrengthHistory is list
        && request.resource.data.therapyHoursHistory is list;
      allow delete: if false;
    }
  }
}
